<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Widget CDN Demo</title>
    <style>
        body {
            font-family: Inter, system-ui, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
        }
        .demo-section {
            background: #f8fafc;
            padding: 2rem;
            border-radius: 1rem;
            margin: 2rem 0;
            border: 1px solid #e2e8f0;
        }
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
        }
        .config-example {
            background: #fff;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }
        h1, h2 { color: #1e293b; }
        .btn {
            background: #0078d4;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
        }
        .btn:hover { background: #005fa3; }
    </style>
</head>
<body>
    <h1>üöÄ Chat Widget CDN</h1>
    <p>A simple, embeddable chat widget that works anywhere. Just add one script tag!</p>

    <div class="demo-section">
        <h2>üì¶ Quick Start</h2>
        <p>Add this single line to any website:</p>
        <div class="code-block">
&lt;script src="https://your-cdn.com/chat-embed.min.js"&gt;&lt;/script&gt;
        </div>
        <p><strong>That's it!</strong> The chat widget will appear in the bottom-right corner.</p>
    </div>

    <div class="demo-section">
        <h2>‚öôÔ∏è Configuration Options</h2>
        <p>Customize the widget by setting <code>SimpleChatEmbedConfig</code> before loading the script:</p>
        <div class="config-example">
            <div class="code-block">
&lt;script&gt;
window.SimpleChatEmbedConfig = {
  apiUrl: "https://your-api.com/chat",
  title: "Help & Support",
  welcomeMessage: "Hi! How can I help you today?",
  theme: {
    primary: "#7c3aed",
    userBubble: "#ede9fe",
    botBubble: "#f3f4f6",
    headerBg: "rgba(124, 58, 237, 0.95)"
  }
};
&lt;/script&gt;
&lt;script src="https://your-cdn.com/chat-embed.min.js"&gt;&lt;/script&gt;
            </div>
        </div>
    </div>

    <div class="demo-section">
        <h2>üé® Theme Customization</h2>
        <p>All theme options:</p>
        <div class="config-example">
            <div class="code-block">
theme: {
  primary: "#0078d4",           // Primary brand color
  userBubble: "#e6f0fa",        // User message background
  botBubble: "#f1f1f1",         // Bot message background
  userText: "#22223b",          // User text color
  botText: "#4a4e69",           // Bot text color
  background: "#fff",           // Widget background
  border: "#ccc",               // Border color
  text: "#222",                 // General text color
  headerText: "#fff",           // Header text color
  headerBg: "rgba(34, 34, 59, 0.95)", // Header background
  inputBg: "#fff",              // Input background
  inputText: "#222",            // Input text color
  sendBtnBg: "#0078d4",         // Send button background
  sendBtnText: "#fff",          // Send button text
  sendBtnHover: "#005fa3",      // Send button hover color
  width: "100%",                // Widget width
  maxWidth: "350px",            // Maximum width
  minWidth: "220px",            // Minimum width
  borderRadius: "8px",          // Border radius
  fontFamily: "sans-serif",     // Font family
  zIndex: 9999                  // Z-index for positioning
}
            </div>
        </div>
    </div>

    <div class="demo-section">
        <h2>üîß Advanced Features</h2>
        
        <h3>Human Agent Handoff</h3>
        <p>Switch to human agent mode programmatically:</p>
        <div class="code-block">
// Switch to human agent
window.SimpleChatEmbedSwitchToHuman(
  'wss://your-backend.com/ws/support/room123/',
  'secure-auth-token'
);
        </div>

        <h3>API Integration</h3>
        <p>The widget expects your API to accept POST requests with this format:</p>
        <div class="code-block">
// Request body
{
  "question": "User's message text",
  "image": "base64-data-url", // For image uploads
  "filename": "image.jpg"     // Original filename
}

// Expected response
{
  "text": "Bot response text",
  // or
  "answer": "Alternative response field"
}
        </div>

        <h3>Lead Capture</h3>
        <p>Built-in lead capture form collects:</p>
        <ul>
            <li>Name and email</li>
            <li>Browser info (user agent, language)</li>
            <li>Page URL and referrer</li>
            <li>IP address</li>
            <li>Unique user GUID</li>
        </ul>
        <p>Access captured lead data via <code>window.SimpleChatEmbedLead</code></p>
    </div>

    <div class="demo-section">
        <h2>üì± Features</h2>
        <ul>
            <li>‚úÖ <strong>Responsive design</strong> - Works on desktop and mobile</li>
            <li>‚úÖ <strong>Image uploads</strong> - Users can send images (max 5MB)</li>
            <li>‚úÖ <strong>Real-time streaming</strong> - Word-by-word AI responses</li>
            <li>‚úÖ <strong>Message persistence</strong> - Chat history saved locally</li>
            <li>‚úÖ <strong>Human handoff</strong> - Switch to live agents via WebSocket</li>
            <li>‚úÖ <strong>Lead capture</strong> - Built-in contact form</li>
            <li>‚úÖ <strong>Markdown links</strong> - Support for [text](url) format</li>
            <li>‚úÖ <strong>No dependencies</strong> - Pure vanilla JavaScript</li>
            <li>‚úÖ <strong>Easy styling</strong> - Complete theme customization</li>
            <li>‚úÖ <strong>Privacy compliant</strong> - GDPR-ready with privacy notice</li>
        </ul>
    </div>

    <div class="demo-section">
        <h2>üöÄ CDN Deployment</h2>
        <p>To deploy your own CDN:</p>
        <ol>
            <li>Upload <code>chat-embed.min.js</code> to your CDN/hosting</li>
            <li>Enable CORS headers</li>
            <li>Set proper cache headers</li>
            <li>Use HTTPS for security</li>
        </ol>
        
        <h3>Example CDN Setup (Cloudflare, AWS CloudFront, etc.)</h3>
        <div class="code-block">
# Required headers
Access-Control-Allow-Origin: *
Cache-Control: public, max-age=31536000
Content-Type: application/javascript
        </div>
    </div>

    <button class="btn" onclick="testCustomConfig()">üé® Try Custom Theme</button>
    <button class="btn" onclick="clearChat()" style="background: #dc2626; margin-left: 1rem;">üóëÔ∏è Clear Chat</button>

    <script>
        function testCustomConfig() {
            // Update config on the fly
            if (window.SimpleChatEmbedConfig) {
                alert('Chat widget already loaded! Refresh page to test new config.');
                return;
            }
            
            window.SimpleChatEmbedConfig = {
                title: "Custom Chat üé®",
                welcomeMessage: "Welcome! This is a custom themed chat widget.",
                theme: {
                    primary: "#7c3aed",
                    userBubble: "#ede9fe",
                    botBubble: "#f3f4f6",
                    headerBg: "rgba(124, 58, 237, 0.95)",
                    sendBtnBg: "#7c3aed",
                    sendBtnHover: "#6d28d9"
                }
            };
            
            // Load the script
            const script = document.createElement('script');
            script.src = './chat-embed.min.js';
            document.head.appendChild(script);
        }

        function clearChat() {
            localStorage.removeItem('simple-chat-messages');
            localStorage.removeItem('simple-chat-leads');
            localStorage.removeItem('simple-chat-user-guid');
            if (window.__simpleChatEmbedLeadCaptured) {
                window.__simpleChatEmbedLeadCaptured = false;
            }
            alert('Chat data cleared! Refresh to reset the widget.');
        }

        // Auto-load with default config if no custom config is set
        if (!window.SimpleChatEmbedConfig) {
            window.SimpleChatEmbedConfig = {
                title: "Demo Chat",
                welcomeMessage: "üëã Hi! This is a demo of the chat widget. Try sending a message!",
                // You'll need to replace this with your actual API URL
                apiUrl: "https://builder.memox.io/api/v1/prediction/832807e0-6eb1-45ae-ab90-1bc0a18e8487"
            };
        }
    </script>

    <!-- Load the chat widget -->
    <script src="./chat-embed.min.js"></script>
</body>
</html>
